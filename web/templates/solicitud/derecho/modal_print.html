{{ define "solicitud/derecho/modal_print" }}
<div
  x-data="{ modalOpen: true, printMode: '' }"
  x-show="modalOpen"
  class="fixed inset-0 z-50 overflow-y-auto"
  aria-labelledby="modal-title"
  role="dialog"
  aria-modal="true"
  x-cloak>
  <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
    <!-- Backdrop -->
    <div
      x-show="modalOpen"
      x-cloak
      class="fixed inset-0 bg-neutral-500 bg-opacity-75 transition-opacity"
      aria-hidden="true"
      x-transition:enter="ease-out duration-300"
      x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100"
      x-transition:leave="ease-in duration-200"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"></div>

    <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

    <!-- Modal Panel -->
    <div
      x-show="modalOpen"
      x-cloak
      x-transition:enter="ease-out duration-300"
      x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
      x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
      x-transition:leave="ease-in duration-200"
      x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
      x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
      class="inline-block align-bottom bg-white rounded-lg text-left overflow-visible shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full">
      <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
        <div class="flex justify-between items-center mb-4 pb-2 border-b">
          <h3 class="text-xl font-bold text-neutral-900" id="modal-title">Vista Previa de Impresión</h3>
          <div class="flex space-x-2">
            <a
              :href="`/solicitudes/derecho/{{ .Solicitud.ID }}/print?mode=` + printMode"
              target="_blank"
              class="inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-800 transition-colors">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
              Descargar PDF
            </a>
            <button @click="modalOpen = false" class="bg-white px-4 py-2 border border-neutral-300 rounded-md text-neutral-700 hover:bg-neutral-50 transition-colors">
              Cerrar
            </button>
          </div>
        </div>

        <!-- Print Mode Controls -->
        {{ if .Solicitud.GetItemVuelta }}
        <div class="flex flex-col sm:flex-row gap-4 mb-4 px-4 py-3 bg-neutral-50 rounded-lg border border-neutral-200">
          <span class="text-xs font-bold text-neutral-500 uppercase tracking-widest self-center mr-2">Opciones de Impresión:</span>
          <label class="inline-flex items-center cursor-pointer select-none">
            <input type="radio" value="" x-model="printMode" class="form-radio text-primary h-4 w-4 border-neutral-300 focus:ring-primary" />
            <span class="ml-2 text-sm font-bold text-neutral-700">Completa (Ida y Vuelta)</span>
          </label>
          <div class="h-4 w-px bg-neutral-300 self-center hidden sm:block"></div>
          <label class="inline-flex items-center cursor-pointer select-none">
            <input type="radio" value="ida" x-model="printMode" class="form-radio text-primary h-4 w-4 border-neutral-300 focus:ring-primary" />
            <span class="ml-2 text-sm font-bold text-neutral-700">Solo Ida</span>
          </label>
          <label class="inline-flex items-center cursor-pointer select-none">
            <input type="radio" value="vuelta" x-model="printMode" class="form-radio text-primary h-4 w-4 border-neutral-300 focus:ring-primary" />
            <span class="ml-2 text-sm font-bold text-neutral-700">Solo Vuelta</span>
          </label>
        </div>
        {{ else }}
        <!-- Single Print Mode (Implicit) -->
        <div class="mb-4 text-sm text-neutral-500 italic px-1">Imprimiendo solicitud completa.</div>
        {{ end }}

        <div class="bg-neutral-100 p-0 rounded-lg overflow-hidden h-[75vh]">
          <iframe :src="`/solicitudes/derecho/{{ .Solicitud.ID }}/print?mode=` + printMode" class="w-full h-full border-0" title="Vista Previa PDF"></iframe>
        </div>
      </div>
    </div>
  </div>
</div>
{{ end }}
